<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>les Données</title>
    <style>
         body {
        background-image: url('https://img.freepik.com/photos-gratuite/paysage-mystique-nature-magenta_23-2150693801.jpg?t=st=1729778509~exp=1729782109~hmac=f17769af2018dbd769bf1db493ce265f207d88aaf31f3db1df2de7094d915d71&w=740');
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
        background-attachment: fixed;
        height: 100vh;
        margin: 0;
        font-family: "Segoe UI Variable Text", sans-serif;
    }

        h2 {
            font-size: 4em;
            font-weight: 600;
            color: #ff0958;
            text-align: center;
        }

        table {
            width: 80%;
            border-collapse: collapse;
            margin: 20px auto;
            color: #000;
            font-size: 1em;
            line-height: 1.5;
        }

        th, td {
            border: 1px solid #ca36c1;
            padding: 10px;
            text-align: center;
            vertical-align: middle;
        }

        th {
            background-color: #cb70c6;
        }

        td {
            background-color: #f7c6f4;
        }

        .filter-wrapper {
            position: relative;
            text-align: center;
        }

        .filter-wrapper button {
            padding: 8px;
            background-color: #eaafea;
            border: 2px solid #ff0958;
            cursor: pointer;
            width: 100%;
        }

        .suggestions {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background-color: #f9cfff;
            border: 1px solid #b874c2;
            max-height: 150px;
            overflow-y: auto;
            list-style: none;
            padding: 0;
            margin: 0;
            z-index: 2;
        }

        .suggestions li {
            padding: 5px;
            cursor: pointer;
            text-align: left;
        }

        .suggestions li:hover {
            background-color: #eb5182;
        }

        .hidden {
            display: none;
        }

        input[type="text"] {
            width: 100%;
            padding: 5px;
            box-sizing: border-box;
            border: 1px solid #b1949c;
        }

        #resetButton {
            padding: 12px 20px;
            background-color: #ff0958;
            color: white;
            border: none;
            cursor: pointer;
            margin-top: 10px;
            display: block;
            margin-left: auto;
            margin-right: auto;
            font-size: 2em;
            font-weight: bold;
        }

        #resetButton:hover {
            background-color: #997c81;
        }

        /* Styles personnalisés pour les champs B et E en vert */
        #caseB, #caseE {
            color: green;
            font-size: 1.5em;
            font-weight: bold;
            width: 150px; /* Largeur augmentée */
        }
		/* Styles personnalisés pour les champs A*/
        #caseA {
            
            font-size: 1.5em;
            font-weight: bold;
            width: 150px; /* Largeur augmentée */
        }

        /* Styles personnalisés pour les champs C et F en bleu */
        #caseC, #caseF {
            color: blue;
            font-size: 1.5em;
            font-weight: bold;
            width: 150px; /* Largeur augmentée */
        }

        /* Section pour les cases à droite */
        .extra-section {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }

        .extra-section .column {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            gap: 10px;
        }

        .extra-section input[type="text"] {
            width: 150px;
        }

        /* Boutons alignés et avec les couleurs des champs E et F */
        .buttons {
            display: flex;
            flex-direction: column;
            gap: 5px; /* Rapprochement des boutons */
        }

        /* Bouton USD en vert */
        #copyButtonE {
            padding: 10px 120px;
            background-color: green;
            color: white;
            border: none;
            cursor: pointer;
            font-size: 1.2em;
        }

        /* Bouton EUR en bleu */
        #copyButtonF {
            padding: 10px 120px;
            background-color: blue;
            color: white;
            border: none;
            cursor: pointer;
            font-size: 1.2em;
        }

        /* Effet hover pour les boutons */
        #copyButtonE:hover {
            background-color: darkgreen;
        }

        #copyButtonF:hover {
            background-color: darkblue;
        }

    </style>
</head>
<body>
    <h2>Tableau de Safaa</h2>
    <button id="resetButton" onclick="resetFilter()">❤</button>

    <div class="extra-section">
        <div class="column">
            <input type="text" id="caseA" placeholder="MT/DEVISE" oninput="calculateResults()">
        </div>
        <div class="column">
            <input type="text" id="caseB" placeholder="TX DE CHANGE" oninput="calculateResults()">
            <input type="text" id="caseC" placeholder="TX DE CHANGE" oninput="calculateResults()">
        </div>
        <div class="column">
            <input type="text" id="caseE" placeholder="RESULT" readonly>
            <input type="text" id="caseF" placeholder="RESULT" readonly>
        </div>
        <div class="buttons">
            <button id="copyButtonE" onclick="copyContent('E')">USD</button>
            <button id="copyButtonF" onclick="copyContent('F')">EUR</button>
        </div>
    </div>

    <div>
        <table>
            <thead>
                <tr>
                    <th>Bureau</th>
                    <th>RÉGIME</th>
                    <th>EXPORTATEUR</th>
                    <th>IMPORTATEUR FAT</th>
                    <th>IMPORTATEUR LIV</th>
                    <th>COMPANY </th>
                    <th>DUM</th>
                    <th>ANNÉE</th>
                </tr>
                <tr>
                    <td class="filter-wrapper">
                        <button id="filterBureau" onclick="showSuggestions('bureau')">Bureau</button>
                        <ul id="bureauSuggestions" class="suggestions hidden"></ul>
                    </td>
                    <td class="filter-wrapper">
                        <button id="filterRegime" onclick="showSuggestions('regime')">Régime</button>
                        <ul id="regimeSuggestions" class="suggestions hidden"></ul>
                    </td>
                    <td><input type="text" id="filterExp" placeholder="Expéditeur" onkeyup="filterTable()"></td>
                    <td><input type="text" id="filterImpFct" placeholder="Import FC" onkeyup="filterTable()"></td>
                    <td><input type="text" id="filterImpLiv" placeholder="Import Liv" onkeyup="filterTable()"></td>
                    <td><input type="text" id="filterCOMPANY" placeholder="COMPANY " onkeyup="filterTable()"></td>
                    <td><input type="text" id="filterDum" placeholder="DUM" onkeyup="filterTable()"></td>
                    <td><input type="text" id="filterAnnee" placeholder="Année" onkeyup="filterTable()"></td>
                </tr>
            </thead>
           <tbody id="dataTable">

<tr>
    <td>300</td><td>070</td><td>CASABLANCA AERONAUTIQUE</td><td>AIRBUS ATLANTIC</td><td>STELIA AEROSPACE ST</td><td>BANSARD</td><td>1882</td><td>2024</td>
</tr>
<tr>
    <td>300</td><td>070</td><td>CASABLANCA AERONAUTIQUE</td><td>PORTELLI PRODUCTIONS</td><td></td><td>BANSARD</td><td>2209</td><td>2024</td>
</tr>
<tr>
    <td>300</td><td>070</td><td>CASABLANCA AERONAUTIQUE</td><td>FIGEAC AERO</td><td></td><td>BANSARD</td><td>2205</td><td>2024</td>
</tr>
<tr>
    <td>300</td><td>070</td><td>CASABLANCA AERONAUTIQUE</td><td>SN AUVERGNE AERONAUTIQUE</td><td></td><td>BANSARD</td><td>2090</td><td>2024</td>
</tr>
<tr>
    <td>300</td><td>070</td><td>CASABLANCA AERONAUTIQUE</td><td>AIRBUS ATLANTIC</td><td>AIRBUS ATLANTIC ST NAZAIRE</td><td>BANSARD</td><td>2091</td><td>2024</td>
</tr>
<tr>
    <td>300</td><td>070</td><td>CASABLANCA AERONAUTIQUE</td><td>AIRBUS ATLANTIC</td><td>STELIA ROCHEFORT</td><td>BANSARD</td><td>2086</td><td>2024</td>
</tr>
<tr>
    <td>300</td><td>070</td><td>CASABLANCA AERONAUTIQUE</td><td>PFW AEROSPACE GMBH</td><td></td><td>BANSARD</td><td>6410</td><td>2023</td>
</tr>
<tr>
    <td>300</td><td>070</td><td>CASABLANCA AERONAUTIQUE</td><td>AIRBUS ATLANTIC</td><td>STELIA MERIGNAC</td><td>BANSARD</td><td>2871</td><td>2024</td>
</tr>
<tr>
    <td>300</td><td>070</td><td>CASABLANCA AERONAUTIQUE</td><td>AIRBUS ATLANTIC</td><td>AIRBUS ATLANTIC LOGISTICS HUB WEST</td><td>BANSARD</td><td>6993</td><td>2024</td>
</tr>
<tr>
    <td>300</td><td>070</td><td>SIMRA MAROC</td><td>SIMRA</td><td></td><td>GEODIS</td><td>2260</td><td>2024</td>
</tr>
<tr>
    <td>300</td><td>070</td><td>SIMRA MAROC</td><td>SUMA GROUPE</td><td></td><td>M&M</td><td>2264</td><td>2024</td>
</tr>
<tr>
    <td>300</td><td>070</td><td>SIMRA MAROC</td><td>DAHER AEROSPACE</td><td></td><td>M&M</td><td>2269</td><td>2024</td>
</tr>
<tr>
    <td>300</td><td>070</td><td>SIMRA MAROC</td><td>DAHER AEROSPACE</td><td>DACHER MARSEILLE CARGOPLUS</td><td>M&M</td><td>2267</td><td>2024</td>
</tr>
<tr>
    <td>300</td><td>070</td><td>SIMRA MAROC</td><td>AIRBUS ATLANTIC</td><td></td><td>M&M</td><td>2263</td><td>2024</td>
</tr>
<tr>
    <td>300</td><td>072</td><td>SIMRA MAROC</td><td>CCA TUNISIE</td><td>DACHER MARSEILLE CARGOPLUS</td><td>M&M</td><td>117</td><td>2024</td>
</tr>
<tr>
    <td>300</td><td>070</td><td>SIMRA MAROC</td><td>CCA TUNISIE</td><td>DACHER MARSEILLE CARGOPLUS</td><td>M&M</td><td>1654</td><td>2024</td>
</tr>
<tr>
    <td>300</td><td>070</td><td>SIMRA MAROC</td><td>TECALEMIT AEROSPACE</td><td></td><td>M&M</td><td>8717</td><td>2022</td>
</tr>
<tr>
    <td>300</td><td>077</td><td>FIGEACAERO MAROC</td><td>HEXAGON METROLOGY</td><td></td><td>BANSARD</td><td>65</td><td>2024</td>
</tr>
<tr>
    <td>300</td><td>751</td><td>FIGEACAERO MAROC</td><td>FIGEACAERO</td><td></td><td>BANSARD</td><td>558</td><td>2024</td>
</tr>
<tr>
    <td>300</td><td>751</td><td>FIGEACAERO MAROC</td><td>FIGEACAERO</td><td>FIGEAC AERO PICARDIE</td><td>BANSARD</td><td>557</td><td>2024</td>
</tr>
<tr>
    <td>300</td><td>060</td><td>FIGEACAERO MAROC</td><td>FIGEAC AERO</td><td></td><td>BANSARD</td><td>2590</td><td>2024</td>
</tr>
<tr>
    <td>300</td><td>751</td><td>FIGEACAERO MAROC</td><td>FIGEACAERO</td><td>FIGEAC AERO TUNISIE</td><td>BANSARD</td><td>549</td><td>2024</td>
</tr>
<tr>
    <td>300</td><td>751</td><td>FIGEACAERO MAROC</td><td>SAFRAN AIRCRAFT ANGINES</td><td></td><td>BANSARD</td><td>548</td><td>2024</td>
</tr>
<tr>
    <td>300</td><td>751</td><td>FIGEACAERO MAROC</td><td>RATIER FIGEAC</td><td></td><td>BANSARD</td><td>547</td><td>2024</td>
</tr>
<tr>
    <td>300</td><td>077</td><td>FIGEACAERO MAROC</td><td>DMG MORI FRANCE SAS</td><td></td><td>BANSARD</td><td>64</td><td>2024</td>
</tr>
<tr>
    <td>300</td><td>751</td><td>FIGEACAERO MAROC</td><td>DMG MORI FRANCE SAS</td><td></td><td>BANSARD</td><td>546</td><td>2024</td>
</tr>
<tr>
    <td>300</td><td>070</td><td>UMP-M</td><td>RATIER FIGEAC</td><td></td><td>GEFCO</td><td>2234</td><td>2024</td>
</tr>
<tr>
    <td>300</td><td>070</td><td>CASABLANCA AERONAUTIQUE</td><td>AIRBUS ATLANTIC</td><td>BLONDEL AEROLOGISTIQUE</td><td>BANSARD</td><td>5057</td><td>2024</td>
</tr>
<tr>
    <td>300</td><td>070</td><td>CASABLANCA AERONAUTIQUE</td><td>CORSE COMPOSITE AERONAUTIQUE</td><td></td><td>BANSARD</td><td>7598</td><td>2024</td>
</tr>
<tr>
    <td>300</td><td>070</td><td>CASABLANCA AERONAUTIQUE</td><td>AIRBUS ATLANTIC ST NAZAIRE</td><td>STELIA AEROSPACE ST</td><td>BANSARD</td><td>7595</td><td>2024</td>
</tr>
<tr>
    <td>300</td><td>070</td><td>CASABLANCA AERONAUTIQUE</td><td>AIRBUS ATLANTIC LOGISTICS HUB WEST</td><td>STELIA AEROSPACE</td><td>BANSARD</td><td>7594</td><td>2024</td>
</tr>
<tr>
    <td>300</td><td>072</td><td>CASABLANCA AERONAUTIQUE</td><td>AIRBUS ATLANTIC</td><td>AIRBUS ATLANTIC LOGISTICS HUB WEST</td><td>BANSARD</td><td>8013</td><td>2024</td>
</tr>
<tr>
    <td>301</td><td>070</td><td>SIMRA MAROC</td><td>F-TECH PYRENEES</td><td></td><td>CHRONOPOST</td><td>6196</td><td>2024</td>
</tr>
<tr>
    <td>301</td><td>070</td><td>SIMRA MAROC</td><td>SAFRAN ELECTRICAL & POWER SAS</td><td></td><td>DHL</td><td>6197</td><td>2024</td>
</tr>
<tr>
    <td>301</td><td>070</td><td>SIMRA MAROC</td><td>SAFRAN ELECTRICIL & POWER USA</td><td>SAFRAN EP MEXIQUE</td><td>DHL</td><td>6198</td><td>2024</td>
</tr>
<tr>
    <td>300</td><td>072</td><td>SIMRA MAROC</td><td>SUMA GROUPE</td><td></td><td>M&M</td><td>5872</td><td>2024</td>
</tr>
<tr>
    <td>300</td><td>070</td><td>SIMRA MAROC</td><td>CORSE COMPOSITE AERONAUTIQUES</td><td></td><td>M&M</td><td>8028</td><td>2024</td>
</tr>
<tr>
    <td>300</td><td>751</td><td>FIGEACAERO MAROC</td><td>MECABRIVE INDUSTRIES</td><td>MECABRIVE INDUSTRIE SAS</td><td>BANSARD</td><td>1976</td><td>2024</td>
</tr>
<tr>
    <td>300</td><td>751</td><td>FIGEACAERO MAROC</td><td>FIGEAC AERO PICARDIE</td><td></td><td>BANSARD</td><td>1979</td><td>2024</td>
</tr>
<tr>
    <td>302</td><td>070</td><td>UMP-M</td><td>WEARE</td><td>BLONDEL AEROLOGISTIQUE</td><td>DACSHER</td><td>1511</td><td>2024</td>
</tr>
<tr>
    <td>300</td><td>072</td><td>SIMRA MAROC</td><td>NIMROD INDUSTRIE</td><td></td><td>BANSARD</td><td>1506</td><td>2024</td>
</tr>
<tr>
    <td>302</td><td>070</td><td>UMP-M</td><td>WEARE</td><td>AIRBUS ATLANTIC</td><td>DACSHER</td><td>1509</td><td>2024</td>
</tr>
<tr>
    <td>302</td><td>070</td><td>UMP-M</td><td>WEARE</td><td>HUB BLONDEL-BL2A SAINT NAZAIRE</td><td>DACSHER</td><td>1510</td><td>2024</td>
</tr>
<tr>
    <td>302</td><td>070</td><td>UMP-M</td><td>WEARE</td><td>AIRBUS ATLANTIC LOGISTICS HUB WEST</td><td>DACSHER</td><td>1505</td><td>2024</td>
</tr>
<tr>
    <td>301</td><td>060</td><td>FIGEACAERO MAROC</td><td>BOMBARDIER</td><td>BOMBARDIER AEROSPACE</td><td>DHL</td><td>29414</td><td>2024</td>
</tr>
<tr>
    <td>301</td><td>751</td><td>FIGEACAERO MAROC</td><td>BOMBARDIER</td><td>BOMBARDIER AEROSPACE</td><td>DHL</td><td>6374</td><td>2024</td>
</tr>
<tr>
    <td>301</td><td>070</td><td>CASABLANCA AERONAUTIQUE</td><td>FIGEAC AERO TUNISIE</td><td></td><td>AUTRES</td><td>6321</td><td>2024</td>
</tr>
<tr>
    <td>301</td><td>060</td><td>FIGEACAERO MAROC</td><td>FIGEAC AERO</td><td></td><td>AUTRES</td><td>26659</td><td>2024</td>
</tr>
<tr>
    <td>301</td><td>751</td><td>FIGEACAERO MAROC</td><td>BOMBARDIER</td><td>BOMBARDIER CANADA</td><td>DHL</td><td>6337</td><td>2024</td>
</tr>
<tr>
    <td>301</td><td>070</td><td>SIMRA MAROC</td><td>STRATA</td><td></td><td>AUTRES</td><td>6227</td><td>2024</td>
</tr>
<tr>
    <td>301</td><td>070</td><td>CASABLANCA AERONAUTIQUE</td><td>BOMBARDIER INC</td><td>BOMBARDIER AEROSPACE</td><td>DHL</td><td>6228</td><td>2024</td>
</tr>
<tr>
    <td>301</td><td>070</td><td>CASABLANCA AERONAUTIQUE</td><td>ISRAEL AEROSPACE INDUSTRIES</td><td></td><td>DHL</td><td>6214</td><td>2024</td>
</tr>
<tr>
    <td>301</td><td>060</td><td>FIGEACAERO MAROC</td><td>BOMBARDIER</td><td>BOMBARDIER AEROSPACE MEXIQUE</td><td>DHL</td><td>28609</td><td>2024</td>
</tr>
<tr>
    <td>301</td><td>060</td><td>FIGEACAERO MAROC</td><td>BOMBARDIER</td><td>BOMBARDIER CANADA</td><td>DHL</td><td>28612</td><td>2024</td>
</tr>
<tr>
    <td>301</td><td>070</td><td>SIMRA MAROC</td><td>COLLINS AEROSPACE</td><td></td><td>AUTRES</td><td>5680</td><td>2024</td>
</tr>
<tr>
    <td>301</td><td>060</td><td>CASABLANCA AERONAUTIQUE</td><td>ISRAEL AEROSPACE INDUSTRIES</td><td></td><td>DHL</td><td>27962</td><td>2024</td>
</tr>
<tr>
    <td>301</td><td>751</td><td>FIGEACAERO MAROC</td><td>BOMBARDIER</td><td></td><td>DHL</td><td>6016</td><td>2024</td>
</tr>
<tr>
    <td>301</td><td>060</td><td>CASABLANCA AERONAUTIQUE</td><td>POTEZ COMPOSITES</td><td></td><td>AUTRES</td><td>27928</td><td>2024</td>
</tr>
<tr>
    <td>301</td><td>070</td><td>CASABLANCA AERONAUTIQUE</td><td>BOMBARDIER INC</td><td>BOMBARDIER AEROSPACE MEXIQUE</td><td>DHL</td><td>28609</td><td>2024</td>
</tr>
<tr>
    <td>301</td><td>070</td><td>CASABLANCA AERONAUTIQUE</td><td>SPIRIT AGROSYSTEMES</td><td></td><td>AUTRES</td><td>28609</td><td>2024</td>
</tr>
<tr>
    <td>301</td><td>751</td><td>FIGEACAERO MAROC</td><td>SAMI FIGEA AERO MANUFACTURING AEROSPACE</td><td></td><td>AUTRES</td><td>5605</td><td>2024</td>
</tr>
<tr>
    <td>301</td><td>060</td><td>CASABLANCA AERONAUTIQUE</td><td>AIRBUS SAS-MATERIAL LOGISTICSES</td><td></td><td>DHL</td><td>26831</td><td>2024</td>
</tr>
<tr>
    <td>301</td><td>060</td><td>CASABLANCA AERONAUTIQUE</td><td>SOOSUNG AIRFRAMZ IND LTD</td><td></td><td>AUTRES</td><td>26505</td><td>2024</td>
</tr>
<tr> 
    <td>301</td><td>077</td><td>CASABLANCA AERONAUTIQUE</td><td>MECAPROTEC</td><td></td><td>CHRONOPOST</td><td>1381</td><td>2024</td>
</tr>
<tr> 
    <td>301</td><td>762</td><td>CASABLANCA AERONAUTIQUE</td><td>AIRBUS ATLANTIC</td><td></td><td>Z.F</td><td>538</td><td>2024</td>
</tr>
<tr> 
    <td>301</td><td>762</td><td>SIMRA MAROC</td><td>AIRBUS ATLANTIC</td><td></td><td>Z.F</td><td>143</td><td>2024</td>
</tr>
<tr> 
    <td>300</td><td>072</td><td>CASABLANCA AERONAUTIQUE</td><td>SAFRAN NACELLES</td><td></td><td>GEFCO</td><td>5917</td><td>2024</td>
</tr>
<tr> 
    <td>301</td><td>077</td><td>CASABLANCA AERONAUTIQUE</td><td>MECABRIVE</td><td></td><td>CHRONOPOST</td><td>1480</td><td>2024</td>
</tr>
<tr> 
    <td>301</td><td>070</td><td>CASABLANCA AERONAUTIQUE</td><td>ABIPA</td><td></td><td>CHRONOPOST</td><td>6252</td><td>2024</td>
</tr>
<tr> 
    <td>301</td><td>077</td><td>FIGEACAERO MAROC</td><td>TOFER</td><td></td><td>CHRONOPOST</td><td>1464</td><td>2024</td>
</tr>
<tr> 
    <td>301</td><td>060</td><td>FIGEACAERO MAROC</td><td>SAFRAN NACELLES</td><td></td><td>CHRONOPOST</td><td>29633</td><td>2024</td>
</tr>
<tr> 
    <td>301</td><td>060</td><td>SIMRA MAROC</td><td>DAHER AEROSPACE SA</td><td></td><td>CHRONOPOST</td><td>29636</td><td>2024</td>
</tr>
<tr> 
    <td>301</td><td>070</td><td>SIMRA MAROC</td><td>SAFRAN NACELLES</td><td>SAFRAN NACELLES AEROSTRUCTURES</td><td>CHRONOPOST</td><td>6354</td><td>2024</td>
</tr>
<tr> 
    <td>301</td><td>070</td><td>SIMRA MAROC</td><td>CENTRAIR SAINT JULIEN DE CHEDON</td><td></td><td>CHRONOPOST</td><td>6353</td><td>2024</td>
</tr>
<tr> 
    <td>301</td><td>751</td><td>FIGEACAERO MAROC</td><td>SAFRAN NACELLE LIMITED</td><td></td><td>CHRONOPOST</td><td>6494</td><td>2024</td>
</tr>
<tr> 
    <td>301</td><td>060</td><td>CASABLANCA AERONAUTIQUE</td><td>TITANIA ENSAYOS Y PROYECTOS IND</td><td></td><td>CHRONOPOST</td><td>29908</td><td>2024</td>
</tr>
<tr> 
    <td>301</td><td>060</td><td>SIMRA MAROC</td><td>FINIMETAUX</td><td></td><td>CHRONOPOST</td><td>29029</td><td>2024</td>
</tr>
<tr> 
    <td>301</td><td>768</td><td>FIGEACAERO MAROC</td><td>HEXCEL COMPOSITES</td><td></td><td>AUTRES</td><td>6</td><td>2024</td>
</tr>
<tr> 
    <td>301</td><td>070</td><td>CASABLANCA AERONAUTIQUE</td><td>MHI CANADA AEROSPACE INC</td><td></td><td>CHRONOPOST</td><td>3982</td><td>2024</td>
</tr>
<tr> 
    <td>301</td><td>070</td><td>SIMRA MAROC</td><td>AIRBUS ATLANTIC COMPOSITES</td><td></td><td>CHRONOPOST</td><td>3980</td><td>2024</td>
</tr>
<tr> 
    <td>301</td><td>070</td><td>SIMRA MAROC</td><td>STACEM</td><td></td><td>CHRONOPOST</td><td>3981</td><td>2024</td>
</tr>
<tr> 
    <td>301</td><td>070</td><td>SIMRA MAROC</td><td>CORSE COMPOSITES AERONAUTIQUES</td><td></td><td>CHRONOPOST</td><td>6311</td><td>2024</td>
</tr>
<tr> 
    <td>301</td><td>072</td><td>SIMRA MAROC</td><td>FACC OPERATIONS GMBH</td><td></td><td>DHL</td><td>2460</td><td>2024</td>
</tr>
<tr> 
    <td>301</td><td>070</td><td>CASABLANCA AERONAUTIQUE</td><td>STELIA AEROSPACE COMPOSITES</td><td></td><td>CHRONOPOST</td><td>6258</td><td>2024</td>
</tr>
<tr> 
    <td>301</td><td>060</td><td>CASABLANCA AERONAUTIQUE</td><td>LABORATOIRE ECCI</td><td></td><td>CHRONOPOST</td><td>29627</td><td>2024</td>
</tr>
            </tbody>
        </table>
    </div>

    <script>
        function copyContent(caseId) {
            // Fonction pour copier le contenu des cases E et F
            const caseValue = document.getElementById(`case${caseId}`).value;
            navigator.clipboard.writeText(caseValue).then(function() {
            }, function() {
                alert('Erreur lors de la copie.');
            });
        }

        function calculateResults() {
            const a = parseFloat(document.getElementById('caseA').value) || 0;
            const b = parseFloat(document.getElementById('caseB').value) || 0;
            const c = parseFloat(document.getElementById('caseC').value) || 0;

            // Utiliser Math.round() pour arrondir les résultats
            document.getElementById('caseE').value = Math.round(a * b);
            document.getElementById('caseF').value = Math.round(a * c);
        }

        // Reste du script déjà existant
       let activeFilters = {}; // Object to store active filters

        // Afficher les suggestions basées sur Bureau ou Régime
        function showSuggestions(type) {
            const table = document.getElementById('dataTable');
            const rows = table.getElementsByTagName('tr');
            const uniqueValues = new Set();
            let listId;

            if (type === 'bureau') {
                listId = 'bureauSuggestions';
                for (let i = 0; i < rows.length; i++) {
                    const bureauValue = rows[i].getElementsByTagName('td')[0].innerText.trim();
                    uniqueValues.add(bureauValue);
                }
            } else if (type === 'regime') {
                listId = 'regimeSuggestions';
                for (let i = 0; i < rows.length; i++) {
                    const regimeValue = rows[i].getElementsByTagName('td')[1].innerText.trim();
                    uniqueValues.add(regimeValue);
                }
            }

            const list = document.getElementById(listId);
            list.innerHTML = '';
            uniqueValues.forEach(value => {
                const li = document.createElement('li');
                li.innerText = value;
                li.onclick = function(event) {
                    event.stopPropagation(); // Empêche la fermeture des suggestions
                    applyFilter(type, value); // Applique le filtre
                    list.classList.add('hidden');
                };
                list.appendChild(li);
            });

            list.classList.remove('hidden');
        }

        // Applique le filtre
        function applyFilter(type, value) {
            activeFilters[type] = value; // Stocke le filtre actif
            filterTable();
        }

        // Cacher les suggestions quand on clique en dehors
        document.addEventListener('click', function(event) {
            if (!event.target.closest('.filter-wrapper') && !event.target.closest('.suggestions')) {
                document.querySelectorAll('.suggestions').forEach(list => {
                    list.classList.add('hidden');
                });
            }
        });

        // les lignes du tableau selon la colonne Bureau ou Régime (pour les suggestions)
        function filterTable() {
            const table = document.getElementById('dataTable');
            const rows = table.getElementsByTagName('tr');

            for (let i = 0; i < rows.length; i++) {
                const cols = rows[i].getElementsByTagName('td');
                let rowVisible = true;

                // Vérifie si le Bureau correspond
                if (activeFilters.bureau && cols[0].innerText.trim() !== activeFilters.bureau) {
                    rowVisible = false;
                }

                // Vérifie si le Régime correspond
                if (activeFilters.regime && cols[1].innerText.trim() !== activeFilters.regime) {
                    rowVisible = false;
                }

                // Vérifie les autres colonnes
                for (let j = 2; j < cols.length; j++) {
                    const filterValue = document.getElementById(`filter${getFilterColumnName(j)}`).value.trim();
                    if (filterValue && !cols[j].innerText.toUpperCase().startsWith(filterValue.toUpperCase())) {
                        rowVisible = false;
                        break;
                    }
                }

                rows[i].style.display = rowVisible ? '' : 'none';
            }
        }

        // Fonction de réinitialisation
        function resetFilter() {
             activeFilters = {}; // Réinitialise les filtres actifs

            // Réinitialise uniquement les champs autres que B, C, E, et F
            document.querySelectorAll('input[type="text"]').forEach(input => {
            if (input.id !== 'caseB' && input.id !== 'caseC' && input.id !== 'caseE' && input.id !== 'caseF') {
            input.value = '';
            }
            });
            document.getElementById('bureauSuggestions').classList.add('hidden');
            document.getElementById('regimeSuggestions').classList.add('hidden');
            const table = document.getElementById('dataTable');
            const rows = table.getElementsByTagName('tr');
            for (let i = 0; i < rows.length; i++) {
                rows[i].style.display = '';
            }
        }

        // Fonction pour obtenir le nom de la colonne en fonction de l'index
        function getFilterColumnName(index) {
            const columnNames = ['Exp', 'ImpFct', 'ImpLiv', 'COMPANY', 'Dum', 'Annee'];
            return columnNames[index - 2];
        }
    </script>
</body>
</html>

